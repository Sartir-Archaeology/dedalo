<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width">
	<link rel="shortcut icon" href="../../favicon.ico" />
	<title><?php echo $tipo .' '. $section_id ?></title>
	<style type="text/css">
		.loading {
			opacity: 0.4;
			pointer-events: none !important;
			-webkit-user-select: none !important;
			-khtml-user-select: none !important;
			-moz-user-select: none !important;
			-o-user-select: none !important;
			user-select: none !important;
			/*transition: opacity 0.25s*/
		}
		.hide {
			display: none !important;
		}
		.invisible {
			visibility: hidden !important;
			opacity: 0 !important;
			height: 0 !important;
			width: 0 !important;
			padding: 0!important;
			margin: 0!important;
		}
	</style>
	<link rel="preconnect" href="<?php echo DEDALO_PROTOCOL . DEDALO_HOST ?>" crossorigin />
	<link rel="preload" href="../common/js/environment.js.php<?php echo '?lang='.DEDALO_APPLICATION_LANG ?>" as="script">
	<link rel="stylesheet" type="text/css" href="../page/css/main.css?v=<?php echo DEDALO_VERSION ?>">
	<?php /*
	<link href="<?php echo DEDALO_CORE_URL ?>/common/css/structure.css" rel="stylesheet">
	<link rel="preload" href="../../lib/tinymce/js/tinymce/skins/lightgray/fonts/tinymce.woff" as="font" type="font/woff" crossorigin>
	<link rel="preload" href="../../lib/tinymce/js/tinymce/skins/lightgray/fonts/tinymce-small.woff" as="font" type="font/woff" crossorigin>
	<link rel="modulepreload" href="../common/js/components_list.js?v=<?php echo DEDALO_VERSION ?>">
	*/?>
	<link rel="modulepreload" href="../page/js/module_preload.js">
	<script rel="preload" defer="defer" src="../common/js/environment.js.php<?php echo '?lang='.DEDALO_APPLICATION_LANG ?>"></script>
</head>
<body>
	<div id="main" class="hide"></div>
	<div id="debug" class="debug hide"></div>


	<script defer="defer" src="../../lib/tinymce/js/tinymce/tinymce.min.js"></script>
	<script type="module">
		const t0 = performance.now()

		// page instance
		import {data_manager} from '../common/js/data_manager.js'
		import {get_instance} from '../common/js/instances.js'
		import {dd_console} from '../common/js/utils/index.js'
		( async () => {

			// main CSS add loading
				const main = document.getElementById("main")
					  main.classList.add("loading")

			// page instance
				const page = await get_instance({
					model	: 'page',
					context	: <?php echo json_encode($context, JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES) ?>
				});

			// page instance build and render
				const build			= await page.build()
				const wrapper_page	= await page.render()

			// main. Add node and restore class
				main.appendChild(wrapper_page)
				main.classList.remove("loading","hide")

			// debug
				if(SHOW_DEBUG===true) {
					// console.log("%c + Page instantiated and rendered total (ms): ", 'background: #000000; color: violet', performance.now()-t0 )
					dd_console(`__Time to Page init, build and render: ${Math.round(performance.now()-t0)} ms`)
				}
		})()
	</script>
</body>
</html>