<!-- PAGE HEADER -->
<?php
# MENU
# Carga el listado del menú de tipo <ul><li></li></ul> generado por el objeto menu
# que se llama desde el controlador de html_page y se visualiza en 'html_page.phtml'
if (login::is_logged()) {
	
	switch (true) {
		case (SHOW_DEBUG===TRUE && DEDALO_DATABASE_CONN=='dedalo4_development' && strpos(DEDALO_HOST,'8888')!==FALSE):
			$menu_wrapper_css = 'menu_wrapper_debug_development';
			break;
		case (SHOW_DEBUG):
			$menu_wrapper_css = 'menu_wrapper_debug';
			break;		
		default:
			$menu_wrapper_css='';
			break;
	}

	
	echo "<div id=\"menu_wrapper\" class=\"$menu_wrapper_css\" >";

		# Quit button
		echo "<div id=\"quit\" class=\"button_in_menu icon_bs link\" title=\"".label::get_label('salir')."\" onclick=\"login.Quit()\"></div>";

		# Icon Dédalo
		echo "\n<a href=\"http://www.fmomo.org/\" target=\"_blank\" class=\"dedalo_icon_top\" title=\"Dédalo version ".DEDALO_VERSION." ( build ".DEDALO_BUILD.")\"></a>";

		# Menu tree
		echo $menu_html;

		# Logged user
		echo "\n<div class=\"button_in_menu logged_user_name\">".navigator::get_username()."</div>";

		
		# log messages in debug mode
		/*
		if(SHOW_DEBUG===TRUE) {
			echo "\n<div class=\"button_in_menu div_log_messages_checkbox\">
					<input type=\"checkbox\" id=\"log_messages_checkbox\" class=\"button_in_menu\" value=\"1\" > 
					Messages
				</div>";
		}
		*/	

		# INSPECTOR : button open / hide sidebar 
		$caller_id = navigator::get_selected('caller_id');
		if( empty($caller_id) && $modo=='edit' ) {
			echo "<!-- Inspector toggle button -->";
			#echo "<div id=\"button_toggle_inspector\" class=\"button_in_menu text_unselectable'\" onclick=\"inspector.toggle_sidebar()\">INSPECTOR $caller_id</div>";
			echo "<div id=\"button_toggle_inspector\" class=\"button_in_menu icon_bs link'\" title=\"".label::get_label('mostrar_inspector')."\" onclick=\"inspector.toggle_sidebar()\"></div>";
		}

		# LANG JUMP
		$dedalo_aplication_langs_selector_html = html_page::get_dedalo_aplication_langs_selector_html();
		echo $dedalo_aplication_langs_selector_html;
		?>


		<?php if (
			SHOW_DEBUG===true && 
			component_security_administrator::is_global_admin(navigator::get_user_id())===true && 
			strpos($_SERVER['REQUEST_URI'], 'dd_list.php')!==false
			) { ?>
			
			<?php # IMPORT BUTTON (ADMIN)
			if( strpos(DEDALO_HOST, 'localhost')===false ) { ?>		
			<a href="javascript:void" class="import_link" onclick="if( confirm('!!!!!!!!!!!!!!!!!!!!!!!!!!! WARNING !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!!!!!! DELETING ACTUAL DATABASE !!!!!!!!!!!!!!!! \n\nAre you sure to IMPORT and overwrite current structure data with LOCAL FILE \n \'dedalo4_development_str.custom.backup\' ?') ) window.open('<?php echo DEDALO_LIB_BASE_URL ?>/backup/trigger.db_utils.php?action=import','Export','width=600,height=300');">
			IMPORT</a>
			<?php
			# LOAD STR DATA
			?>
			<a href="javascript:void" class="import_link" onclick="if( confirm('!!!!!!!!!!!!!!!!!!!!!!!!!!! WARNING !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!!!!!! DELETING ACTUAL DATABASE !!!!!!!!!!!!!!!! \n\nAre you sure to LOAD and overwrite current structure data with LOCAL FILE ?') ) window.open('<?php echo DEDALO_LIB_BASE_URL ?>/backup/trigger.db_utils.php?action=load_str_data','Load str','width=800,height=400');">
			LOAD</a>
			<?php } #if(SHOW_DEBUG===TRUE) ?>

			<?php # EXPORT BUTTON (ADMIN)
			if( 
				DEDALO_DATABASE_CONN=='dedalo4_development' 
				&& strpos(DEDALO_HOST,'localhost:8888')!==false 
				|| (DEDALO_DATABASE_CONN=='dedalo4_development2')
			) { ?>
			<a href="javascript:void" class="export_link" onclick="if( confirm('Sure to EXPORT and overwrite structure data in file \n \'dedalo4_development_str.custom.backup\' \nfile?') ) window.open('<?php echo DEDALO_LIB_BASE_URL ?>/backup/trigger.db_utils.php?action=export','Export','width=600,height=600');" >
			EXPORT</a> 
			<?php 
			} 
			?>

		<?php } ?>
		
		

		<?php
		# SECTION : label
		$current_selected_area = navigator::get_selected('area');
		if(!empty($current_selected_area)) {
			$section_tipo 	= $current_selected_area;
			$section_name 	= RecordObj_dd::get_termino_by_tipo($section_tipo,DEDALO_APPLICATION_LANG,true);
			if($section_name  && ( SHOW_DEBUG===true) ) {
				$current_table 	= common::get_matrix_table_from_tipo($section_tipo);
				$section_name .= " [$current_table]";
			}		
			echo "<!-- Section label -->";
			if( !empty($section_tipo) && $modo=='list' ) {
				echo "<div id=\"current_section_label\" class=\"button_in_menu css_label text_unselectable cursor_default\">$section_name</div>";
			}else if(!empty($section_tipo)) {
				echo "<div id=\"current_section_label\" class=\"button_in_menu css_label text_unselectable\" title=\"".label::get_label('ir_a_seccion')."\" onclick=\"goto_url('?m=list&t=$section_tipo')\">";				
				echo $section_name;
				echo ' <span id="current_section_id_label">'.section::$active_section_id.'</span>';
				echo "</div>";

			}
		}#end if(!empty($current_selected_area))
		
	
	echo "</div><!-- /menu_wrapper -->\n";

	# Sólo se usa para ocupar el espacio del mewnu_wrapper ya que este es de posición fija y no ocupa espacio en la página	
	echo "<div class=\"menu_wrapper_space\"></div>";
}
?>



<?php /*

	<?php if (login::is_logged()) {
		#echo "<div class=\"icon_bs link\" id=\"quit\" title=\"".label::get_label('salir')."\"></div>";
	}else{			

		if( strpos(DEDALO_HOST, 'debug:8888')!==false || (isset($_REQUEST['larana']) && $_REQUEST['larana']=='cantora') ) { 
			?>
			<div class="dedalo_header_info_div">
			<?php echo " Database: <b>".DEDALO_DATABASE_CONN . "</b> " ?>
			
			<?php if( DEDALO_DATABASE_CONN=='dedalo4_development' && isset($variable_imposible_de_existir) ) { ?>
			<a href="javascript:void"
			onclick="if( confirm('Sure to EXPORT and overwrite structure file \n <?php echo DEDALO_DATABASE_CONN ?>.sql \nfile?') ) window.open('<?php echo DEDALO_LIB_BASE_URL ?>/backup/trigger.db_utils.php?action=export','Export','width=600,height=200');" 
			>STR DB Export</a> | 
			<?php } #if( DEDALO_DATABASE_CONN=='dedalo4_development' ) ?>
			
			<a href="javascript:void"
			onclick="if( confirm('Sure to IMPORT and overwrite current structure data in active DB from file \n  dedalo4_development -> <?php echo DEDALO_DATABASE_CONN ?> \nMySQL Database?') ) window.open('<?php echo DEDALO_LIB_BASE_URL ?>/backup/trigger.db_utils.php?action=import','Export','width=600,height=200');"
			>STR DB Import</a> |

			<a href="javascript:;" onclick="$(document).fullScreen(true)">Fullscreen</a>
			</div><!-- /dedalo_header_info_div -->
			<?php
		}# /if( isset($_REQUEST['larana'] && $_REQUEST['larana']='cantora') 

	}
	?>

*/ ?>